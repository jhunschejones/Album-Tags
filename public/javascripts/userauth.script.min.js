console.log('The custom script for the userauth page is running');function hideDOMelement(elementId){try{let element=document.getElementById(elementId)
    element.style.display="none"}catch(error){}}
    function showDOMelement(elementId){try{let element=document.getElementById(elementId)
    element.style.display="block"}catch(error){}}
    var config={apiKey:"AIzaSyD1Hts7zVBvDXUf-sCb89hcPesJkrUKyUc",authDomain:"album-tag-auth.firebaseapp.com",databaseURL:"https://album-tag-favorites.firebaseio.com/",projectId:"album-tag-auth",storageBucket:"album-tag-auth.appspot.com",messagingSenderId:"1048555394172"};const app1=firebase.initializeApp(config);const app2=firebase.initializeApp({apiKey:"AIzaSyD1Hts7zVBvDXUf-sCb89hcPesJkrUKyUc",databaseURL:"https://album-tag-connections.firebaseio.com/",projectId:"album-tag-auth"},'app2');const app3=firebase.initializeApp({apiKey:"AIzaSyD1Hts7zVBvDXUf-sCb89hcPesJkrUKyUc",databaseURL:"https://album-tag-auth.firebaseio.com/",projectId:"album-tag-auth"},'app3');var database1=firebase.database(app2);var database2=firebase.database(app3);const allowedUsers=["joshjones103@gmail.com","znoffy5@gmail.com","devon.curry891@gmail.com","milesjohnsonmusic@gmail.com","austinhuelsbeck@gmail.com"];var loginButton=document.getElementById("login_button");var loginButton2=document.getElementById("full_menu_login_button")
    var logoutButton=document.getElementById("logout_button");var logoutButton2=document.getElementById("full_menu_logout_button")
    var logInMessage=document.getElementById("log_in_message");var loader=document.getElementById("loader");var userEmail="";var userName="";var user=firebase.auth().currentUser;var userID;var dbRefrence;firebase.auth().onAuthStateChanged(function(user){if(user){$('.hide_when_logged_in').addClass('hide_me');$('.hide_when_logged_out').removeClass('hide_me');showDOMelement("full_menu_login_logout_container");userEmail=user.email;userName=user.displayName;userID=user.uid;try{updateFavoriteAlbums()}catch(error){}
    try{updateConnectedAlbums()}catch(error){}
    try{populateUserData()}catch(error){}
    if(allowedUsers.indexOf(userEmail)>-1){tagUpdatePermissionsGranted();var whatTagsToShow=sessionStorage.getItem('tags');if(whatTagsToShow!='All Tags'){sessionStorage.setItem('tags','My Tags');filterDisplayedTags()}else{allTagsNoFilter()}}
    else{tagUpdatePermissionsGranted();var whatTagsToShow=sessionStorage.getItem('tags');if(whatTagsToShow!='All Tags'){sessionStorage.setItem('tags','My Tags');filterDisplayedTags()}}}else{noUserSignedIn()}});function noUserSignedIn(){try{logInMessage.innerHTML='<div class="container-fluid please_log_in"><p class="text-danger">Please sign in to access this feature</p> <button onclick="logIn()" class="btn btn-danger" id="login_link">Log In</button></div>'}catch(error){}
    hideDOMelement("loader");$('.hide_when_logged_in').removeClass('hide_me');$('.hide_when_logged_out').addClass('hide_me');showDOMelement("full_menu_login_logout_container")}
    function tagUpdatePermissionsGranted(){var whatTagsToShow=sessionStorage.getItem('tags');if(whatTagsToShow!='My Tags'&whatTagsToShow!='All Tags'){sessionStorage.setItem('tags','My Tags')}
    $("#update_button_container").html('<a href="" onclick="goToUpdatePage()" class="btn btn-sm btn-outline-secondary update_button hide_when_logged_out">Update<span class="button_text"> Tags</span></a>');$("#tags_toggle").html('<img src="/images/toggle_off.png" id="show_only_my_tags" class="hide_when_logged_out" style="height:24px;margin-top:17px;margin-left:5px;" onclick="showAllTags()"data-toggle="tooltip" data-placement="right" title="Show All Tags"><img src="/images/toggle_on.png" class="hide_when_logged_out" id="show_all_tags" style="height:24px;margin-top:17px;margin-left:5px;" onclick="showOnlyMyTags()" data-toggle="tooltip" data-placement="right" title="Only Show My Tags">');$("#connection_button_container").html('<a href="" onclick="goToUpdatePage()" class="btn btn-sm btn-outline-secondary update_button hide_when_logged_out">Update Connections</a>');try{logInMessage.innerHTML=""}catch(error){}
    try{checkUserDisplayPrefrences()}catch(error){}}
    function filterDisplayedTags(){try{let anyTagsOnPage=!1
    tagsForThisAlbum=$(".album_details_tags")
    for(let index=0;index<tagsForThisAlbum.length;index++){let thisTag=tagsForThisAlbum[index];if($(thisTag).hasClass(`author-${userID}`)){$(thisTag).show()
    anyTagsOnPage=!0}else{$(thisTag).hide()}}
    if(anyTagsOnPage==!0){$(".tag_search_button").show()}else{$(".tag_search_button").hide()
    $('#tag_results').html('<small class="text-primary">You currently have no tags for this album!</small>')}}catch(error){}}
    function allTagsNoFilter(){try{let anyTagsOnPage=!1
    tagsForThisAlbum=$(".album_details_tags")
    if(tagsForThisAlbum.length>0){anyTagsOnPage=!0
    for(let index=0;index<tagsForThisAlbum.length;index++){let thisTag=tagsForThisAlbum[index];$(thisTag).show()}}
    if(anyTagsOnPage==!0){$(".tag_search_button").show()}else{$(".tag_search_button").hide()
    $('#tag_results').html('<small class="text-primary">There are currently no tags for this album!</small>')}}catch(error){}}
    function logIn(){firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function(){var provider=new firebase.auth.GoogleAuthProvider();return firebase.auth().signInWithPopup(provider)}).then(function(result){var token=result.credential.accessToken;userEmail=result.user.email}).catch(function(error){var errorCode=error.code;var errorMessage=error.message;var email=error.email;var credential=error.credential})};function goToUpdatePage(){event.preventDefault();let url=window.location.href;url=url.replace("albumdetails","update");window.location=url};function logOut(){firebase.auth().signOut().then(function(){noUserSignedIn()}).catch(function(error){})};loginButton.addEventListener("click",logIn);loginButton2.addEventListener("click",logIn);logoutButton.addEventListener("click",logOut);logoutButton2.addEventListener("click",logOut)